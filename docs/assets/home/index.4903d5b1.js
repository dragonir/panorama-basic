import{r as Fe,c as Xe,o as We,e as j,f as U,g as E,F as ye,q as ge,u as we,v as Ve,x as Ee,y as ve,t as q,z as Pe,A as Be,B as Ke,C as qe}from"../@vue/@vue.513fea8a.js";import{E as $e,V as g,M as C,T as I,Q as _e,S as xe,a as L,b as Z,W as Ge,c as Qe,P as Je,d as et,R as tt,e as nt,f as ot,D as at,g as it}from"../three/three.93ff3bc9.js";import{_ as st}from"../index-b936d60e.js";import"../vendor/vendor.7826b337.js";const Te={type:"change"},$={type:"start"},Le={type:"end"};class rt extends $e{constructor(c,a){super(),a===void 0&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),a===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=c,this.domElement=a,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new g,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:C.ROTATE,MIDDLE:C.DOLLY,RIGHT:C.PAN},this.touches={ONE:I.ROTATE,TWO:I.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return o.phi},this.getAzimuthalAngle=function(){return o.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(t){t.addEventListener("keydown",ue),this._domElementKeyEvents=t},this.saveState=function(){e.target0.copy(e.target),e.position0.copy(e.object.position),e.zoom0=e.object.zoom},this.reset=function(){e.target.copy(e.target0),e.object.position.copy(e.position0),e.object.zoom=e.zoom0,e.object.updateProjectionMatrix(),e.dispatchEvent(Te),e.update(),d=r.NONE},this.update=function(){const t=new g,n=new _e().setFromUnitVectors(c.up,new g(0,1,0)),f=n.clone().invert(),b=new g,_=new _e,N=2*Math.PI;return function(){const be=e.object.position;t.copy(be).sub(e.target),t.applyQuaternion(n),o.setFromVector3(t),e.autoRotate&&d===r.NONE&&X(F()),e.enableDamping?(o.theta+=i.theta*e.dampingFactor,o.phi+=i.phi*e.dampingFactor):(o.theta+=i.theta,o.phi+=i.phi);let A=e.minAzimuthAngle,S=e.maxAzimuthAngle;return isFinite(A)&&isFinite(S)&&(A<-Math.PI?A+=N:A>Math.PI&&(A-=N),S<-Math.PI?S+=N:S>Math.PI&&(S-=N),A<=S?o.theta=Math.max(A,Math.min(S,o.theta)):o.theta=o.theta>(A+S)/2?Math.max(A,o.theta):Math.min(S,o.theta)),o.phi=Math.max(e.minPolarAngle,Math.min(e.maxPolarAngle,o.phi)),o.makeSafe(),o.radius*=m,o.radius=Math.max(e.minDistance,Math.min(e.maxDistance,o.radius)),e.enableDamping===!0?e.target.addScaledVector(u,e.dampingFactor):e.target.add(u),t.setFromSpherical(o),t.applyQuaternion(f),be.copy(e.target).add(t),e.object.lookAt(e.target),e.enableDamping===!0?(i.theta*=1-e.dampingFactor,i.phi*=1-e.dampingFactor,u.multiplyScalar(1-e.dampingFactor)):(i.set(0,0,0),u.set(0,0,0)),m=1,w||b.distanceToSquared(e.object.position)>l||8*(1-_.dot(e.object.quaternion))>l?(e.dispatchEvent(Te),b.copy(e.object.position),_.copy(e.object.quaternion),w=!1,!0):!1}}(),this.dispose=function(){e.domElement.removeEventListener("contextmenu",me),e.domElement.removeEventListener("pointerdown",le),e.domElement.removeEventListener("pointercancel",de),e.domElement.removeEventListener("wheel",pe),e.domElement.removeEventListener("pointermove",V),e.domElement.removeEventListener("pointerup",B),e._domElementKeyEvents!==null&&e._domElementKeyEvents.removeEventListener("keydown",ue)};const e=this,r={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let d=r.NONE;const l=1e-6,o=new xe,i=new xe;let m=1;const u=new g;let w=!1;const O=new L,R=new L,M=new L,k=new L,x=new L,p=new L,h=new L,T=new L,P=new L,s=[],v={};function F(){return 2*Math.PI/60/60*e.autoRotateSpeed}function D(){return Math.pow(.95,e.zoomSpeed)}function X(t){i.theta+=t}function G(t){i.phi+=t}const Q=function(){const t=new g;return function(f,b){t.setFromMatrixColumn(b,0),t.multiplyScalar(-f),u.add(t)}}(),J=function(){const t=new g;return function(f,b){e.screenSpacePanning===!0?t.setFromMatrixColumn(b,1):(t.setFromMatrixColumn(b,0),t.crossVectors(e.object.up,t)),t.multiplyScalar(f),u.add(t)}}(),z=function(){const t=new g;return function(f,b){const _=e.domElement;if(e.object.isPerspectiveCamera){const N=e.object.position;t.copy(N).sub(e.target);let Y=t.length();Y*=Math.tan(e.object.fov/2*Math.PI/180),Q(2*f*Y/_.clientHeight,e.object.matrix),J(2*b*Y/_.clientHeight,e.object.matrix)}else e.object.isOrthographicCamera?(Q(f*(e.object.right-e.object.left)/e.object.zoom/_.clientWidth,e.object.matrix),J(b*(e.object.top-e.object.bottom)/e.object.zoom/_.clientHeight,e.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),e.enablePan=!1)}}();function W(t){e.object.isPerspectiveCamera?m/=t:e.object.isOrthographicCamera?(e.object.zoom=Math.max(e.minZoom,Math.min(e.maxZoom,e.object.zoom*t)),e.object.updateProjectionMatrix(),w=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),e.enableZoom=!1)}function ee(t){e.object.isPerspectiveCamera?m*=t:e.object.isOrthographicCamera?(e.object.zoom=Math.max(e.minZoom,Math.min(e.maxZoom,e.object.zoom/t)),e.object.updateProjectionMatrix(),w=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),e.enableZoom=!1)}function te(t){O.set(t.clientX,t.clientY)}function Re(t){h.set(t.clientX,t.clientY)}function ne(t){k.set(t.clientX,t.clientY)}function Me(t){R.set(t.clientX,t.clientY),M.subVectors(R,O).multiplyScalar(e.rotateSpeed);const n=e.domElement;X(2*Math.PI*M.x/n.clientHeight),G(2*Math.PI*M.y/n.clientHeight),O.copy(R),e.update()}function ke(t){T.set(t.clientX,t.clientY),P.subVectors(T,h),P.y>0?W(D()):P.y<0&&ee(D()),h.copy(T),e.update()}function Ae(t){x.set(t.clientX,t.clientY),p.subVectors(x,k).multiplyScalar(e.panSpeed),z(p.x,p.y),k.copy(x),e.update()}function Se(t){t.deltaY<0?ee(D()):t.deltaY>0&&W(D()),e.update()}function De(t){let n=!1;switch(t.code){case e.keys.UP:z(0,e.keyPanSpeed),n=!0;break;case e.keys.BOTTOM:z(0,-e.keyPanSpeed),n=!0;break;case e.keys.LEFT:z(e.keyPanSpeed,0),n=!0;break;case e.keys.RIGHT:z(-e.keyPanSpeed,0),n=!0;break}n&&(t.preventDefault(),e.update())}function oe(){if(s.length===1)O.set(s[0].pageX,s[0].pageY);else{const t=.5*(s[0].pageX+s[1].pageX),n=.5*(s[0].pageY+s[1].pageY);O.set(t,n)}}function ae(){if(s.length===1)k.set(s[0].pageX,s[0].pageY);else{const t=.5*(s[0].pageX+s[1].pageX),n=.5*(s[0].pageY+s[1].pageY);k.set(t,n)}}function ie(){const t=s[0].pageX-s[1].pageX,n=s[0].pageY-s[1].pageY,f=Math.sqrt(t*t+n*n);h.set(0,f)}function ze(){e.enableZoom&&ie(),e.enablePan&&ae()}function Ne(){e.enableZoom&&ie(),e.enableRotate&&oe()}function se(t){if(s.length==1)R.set(t.pageX,t.pageY);else{const f=K(t),b=.5*(t.pageX+f.x),_=.5*(t.pageY+f.y);R.set(b,_)}M.subVectors(R,O).multiplyScalar(e.rotateSpeed);const n=e.domElement;X(2*Math.PI*M.x/n.clientHeight),G(2*Math.PI*M.y/n.clientHeight),O.copy(R)}function re(t){if(s.length===1)x.set(t.pageX,t.pageY);else{const n=K(t),f=.5*(t.pageX+n.x),b=.5*(t.pageY+n.y);x.set(f,b)}p.subVectors(x,k).multiplyScalar(e.panSpeed),z(p.x,p.y),k.copy(x)}function ce(t){const n=K(t),f=t.pageX-n.x,b=t.pageY-n.y,_=Math.sqrt(f*f+b*b);T.set(0,_),P.set(0,Math.pow(T.y/h.y,e.zoomSpeed)),W(P.y),h.copy(T)}function Ce(t){e.enableZoom&&ce(t),e.enablePan&&re(t)}function Ie(t){e.enableZoom&&ce(t),e.enableRotate&&se(t)}function le(t){e.enabled!==!1&&(s.length===0&&(e.domElement.setPointerCapture(t.pointerId),e.domElement.addEventListener("pointermove",V),e.domElement.addEventListener("pointerup",B)),Ze(t),t.pointerType==="touch"?Ye(t):je(t))}function V(t){e.enabled!==!1&&(t.pointerType==="touch"?He(t):Ue(t))}function B(t){he(t),s.length===0&&(e.domElement.releasePointerCapture(t.pointerId),e.domElement.removeEventListener("pointermove",V),e.domElement.removeEventListener("pointerup",B)),e.dispatchEvent(Le),d=r.NONE}function de(t){he(t)}function je(t){let n;switch(t.button){case 0:n=e.mouseButtons.LEFT;break;case 1:n=e.mouseButtons.MIDDLE;break;case 2:n=e.mouseButtons.RIGHT;break;default:n=-1}switch(n){case C.DOLLY:if(e.enableZoom===!1)return;Re(t),d=r.DOLLY;break;case C.ROTATE:if(t.ctrlKey||t.metaKey||t.shiftKey){if(e.enablePan===!1)return;ne(t),d=r.PAN}else{if(e.enableRotate===!1)return;te(t),d=r.ROTATE}break;case C.PAN:if(t.ctrlKey||t.metaKey||t.shiftKey){if(e.enableRotate===!1)return;te(t),d=r.ROTATE}else{if(e.enablePan===!1)return;ne(t),d=r.PAN}break;default:d=r.NONE}d!==r.NONE&&e.dispatchEvent($)}function Ue(t){if(e.enabled!==!1)switch(d){case r.ROTATE:if(e.enableRotate===!1)return;Me(t);break;case r.DOLLY:if(e.enableZoom===!1)return;ke(t);break;case r.PAN:if(e.enablePan===!1)return;Ae(t);break}}function pe(t){e.enabled===!1||e.enableZoom===!1||d!==r.NONE||(t.preventDefault(),e.dispatchEvent($),Se(t),e.dispatchEvent(Le))}function ue(t){e.enabled===!1||e.enablePan===!1||De(t)}function Ye(t){switch(fe(t),s.length){case 1:switch(e.touches.ONE){case I.ROTATE:if(e.enableRotate===!1)return;oe(),d=r.TOUCH_ROTATE;break;case I.PAN:if(e.enablePan===!1)return;ae(),d=r.TOUCH_PAN;break;default:d=r.NONE}break;case 2:switch(e.touches.TWO){case I.DOLLY_PAN:if(e.enableZoom===!1&&e.enablePan===!1)return;ze(),d=r.TOUCH_DOLLY_PAN;break;case I.DOLLY_ROTATE:if(e.enableZoom===!1&&e.enableRotate===!1)return;Ne(),d=r.TOUCH_DOLLY_ROTATE;break;default:d=r.NONE}break;default:d=r.NONE}d!==r.NONE&&e.dispatchEvent($)}function He(t){switch(fe(t),d){case r.TOUCH_ROTATE:if(e.enableRotate===!1)return;se(t),e.update();break;case r.TOUCH_PAN:if(e.enablePan===!1)return;re(t),e.update();break;case r.TOUCH_DOLLY_PAN:if(e.enableZoom===!1&&e.enablePan===!1)return;Ce(t),e.update();break;case r.TOUCH_DOLLY_ROTATE:if(e.enableZoom===!1&&e.enableRotate===!1)return;Ie(t),e.update();break;default:d=r.NONE}}function me(t){e.enabled!==!1&&t.preventDefault()}function Ze(t){s.push(t)}function he(t){delete v[t.pointerId];for(let n=0;n<s.length;n++)if(s[n].pointerId==t.pointerId){s.splice(n,1);return}}function fe(t){let n=v[t.pointerId];n===void 0&&(n=new L,v[t.pointerId]=n),n.set(t.pageX,t.pageY)}function K(t){const n=t.pointerId===s[0].pointerId?s[1]:s[0];return v[n.pointerId]}e.domElement.addEventListener("contextmenu",me),e.domElement.addEventListener("pointerdown",le),e.domElement.addEventListener("pointercancel",de),e.domElement.addEventListener("wheel",pe,{passive:!1}),this.update()}}const ct={animateCamera:(y,c,a,e,r=2e3,d)=>{const l=new Z.Tween({x1:y.position.x,y1:y.position.y,z1:y.position.z,x2:c.target.x,y2:c.target.y,z2:c.target.z});l.to({x1:a.x,y1:a.y,z1:a.z,x2:e.x,y2:e.y,z2:e.z},r),l.onUpdate(function(o){y.position.x=o.x1,y.position.y=o.y1,y.position.z=o.z1,c.target.x=o.x2,c.target.y=o.y2,c.target.z=o.z2,c.update()}),l.onComplete(function(){c.enabled=!0,c.update(),d()}),l.easing(Z.Easing.Cubic.InOut),l.start()}},lt=y=>new Promise(c=>{setTimeout(c,y)}),dt=(y,c)=>{var a=document.createElement("div");a.style.position="fixed",a.style.maxWidth="80%",a.style.color="white",a.style.fontSize="14px",a.style.boxSizing="border-box",a.style.background="rgba(0,0,0,0.76)",a.style.padding="0.8em 2.618em",a.style.top="40%",a.style.left="50%",a.style.zIndex=999999999,a.style.borderRadius="3px",a.style.opacity="0",a.innerText=y,document.body.appendChild(a),a.style.marginLeft=-(a.offsetWidth/2)+"px",a.style.marginTop=-a.offsetHeight/2+"px",setTimeout(function(){a.style.marginLeft=-(a.offsetWidth/2)+"px",a.style.marginTop=-a.offsetHeight+"px",a.style.transition="all 0.3s",a.style.opacity="1",setTimeout(function(){a.style.opacity="0",a.style.marginTop=-a.offsetHeight/2+"px",setTimeout(function(){document.body.removeChild(a)},300)},parseInt(c)||1618)},0)},H=[{name:"客厅",key:"living-room",map:new URL(""+new URL("../map_living_room-3b943256.jpg",import.meta.url).href,self.location).href,showSwitch:!0,position:new g(0,0,0),interactivePoints:[{key:"tv",value:"电视机",description:"智能电视",cover:new URL(""+new URL("../cover_living_room_tv-73e5fbd3.png",import.meta.url).href,self.location).href,position:new g(-6,2,-8)},{key:"fridge",value:"冰箱",description:"豪华冰箱",cover:new URL(""+new URL("../cover_living_room_fridge-be328301.png",import.meta.url).href,self.location).href,position:new g(-12,4,9)},{key:"sofa",value:"沙发",description:"舒适沙发",cover:new URL(""+new URL("../cover_living_room_sofa-7272eb82.png",import.meta.url).href,self.location).href,position:new g(6,0,-8)}]},{name:"卧室",key:"bed-room",map:new URL(""+new URL("../map_bed_room-54905436.jpg",import.meta.url).href,self.location).href,showSwitch:!0,position:new g(-32,0,0),interactivePoints:[{key:"bed",value:"床",description:"温暖的床",cover:new URL(""+new URL("../cover_bed_room_bed-b049b23b.png",import.meta.url).href,self.location).href,position:new g(-38,2,-14)}]},{name:"书房",key:"study-room",map:new URL(""+new URL("../map_study_room-e6b1d86f.jpg",import.meta.url).href,self.location).href,showSwitch:!0,position:new g(32,0,0),interactivePoints:[{key:"art",value:"艺术品",description:"绝版作品",cover:new URL(""+new URL("../cover_study_room_art-bdfabd4f.png",import.meta.url).href,self.location).href,position:new g(42,6,-8)}]}];const Oe=y=>(Ke("data-v-6ace4ada"),y=y(),qe(),y),pt={class:"home"},ut=Ve('<canvas class="webgl" data-v-6ace4ada></canvas><div class="vr" data-v-6ace4ada><span class="box" data-v-6ace4ada><i class="icon" data-v-6ace4ada></i><b class="text" data-v-6ace4ada>全景漫游</b></span></div>',2),mt={class:"switch"},ht=["onClick"],ft={class:"text"},bt=Oe(()=>E("i",{class:"icon"},null,-1)),yt=["onClick"],gt={class:"label-tips"},wt={class:"cover"},Et={class:"info"},vt={class:"p1"},Pt={class:"p2"},_t=Oe(()=>E("a",{class:"github",href:"https://github.com/dragonir/threejs-odessey",target:"_blank",rel:"noreferrer"},[E("svg",{height:"40","aria-hidden":"true",viewBox:"0 0 16 16",version:"1.1",width:"40","data-view-component":"true"},[E("path",{fill:"#6df45c",fillRule:"evenodd",d:"M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"})]),E("span",{class:"author"},"three.js odessey")],-1)),xt={__name:"index",setup(y){const c=Fe({renderer:null,camera:null,scene:null,controls:null,cameraZAxis:2,currentRoom:"living-room"}),a=Xe(()=>{const l=[];return H.forEach(o=>{o.interactivePoints&&o.interactivePoints.length>0&&o.interactivePoints.forEach(i=>{i={room:o.key,...i},l.push(i)})}),l}),e=()=>{const l={width:window.innerWidth,height:window.innerHeight},o=document.querySelector("canvas.webgl"),i=new Ge({canvas:o});i.setSize(l.width,l.height),i.setPixelRatio(Math.min(window.devicePixelRatio,2)),c.renderer=i;const m=new Qe;c.scene=m;const u=new Je(65,l.width/l.height,.1,1e3);u.position.z=c.cameraZAxis,m.add(u),c.camera=u;const w=new rt(u,i.domElement);w.target.set(0,0,0),w.enableDamping=!0,w.enablePan=!1,w.maxDistance=12,w.minPolarAngle=Math.PI/2,w.maxPolarAngle=Math.PI/2,c.controls=w,window.addEventListener("resize",()=>{l.width=window.innerWidth,l.height=window.innerHeight,i.setSize(l.width,l.height),i.setPixelRatio(Math.min(window.devicePixelRatio,2)),u.aspect=l.width/l.height,u.updateProjectionMatrix()});const O=new et,R=(p,h,T)=>{const P=new nt(16,256,256);P.scale(1,1,-1);const s=new ot({map:O.load(T),side:at}),v=new it(P,s);return v.name=p,v.position.set(h.x,h.y,h.z),v.rotation.y=Math.PI/2,m.add(v),v};H.map(p=>R(p.key,p.position,p.map));const M=new tt,k=a.value.map((p,h)=>({...p,element:document.querySelector(`.point-${h}`)})),x=()=>{if(i)for(const p of k){const h=p.position.clone(),T=h.project(u);M.setFromCamera(h,u);const P=M.intersectObjects(m.children,!0);if(P.length===0)p.element.classList.add("visible");else{const F=P[0].distance,D=p.position.distanceTo(u.position);F<D?p.element.classList.remove("visible"):p.element.classList.add("visible")}T.z>1?p.element.classList.remove("visible"):p.element.classList.add("visible");const s=h.x*l.width*.5,v=-h.y*l.height*.5;p.element.style.transform=`translateX(${s}px) translateY(${v}px)`}w&&w.update(),Z&&Z.update(),i.render(m,u),window.requestAnimationFrame(x)};x()},r=async l=>{const o=H.filter(i=>i.key===l)[0];if(c.camera){const i=o.position.x,m=o.position.y,u=o.position.z;ct.animateCamera(c.camera,c.controls,{x:i,y:m,z:c.cameraZAxis},{x:i,y:m,z:u},1600,()=>{}),c.controls.update()}await lt(1600),c.currentRoom=o.key},d=l=>{dt(`您点击了${l.value}`)};return We(()=>{e()}),(l,o)=>(j(),U("div",pt,[ut,E("div",mt,[(j(!0),U(ye,null,ge(we(H),(i,m)=>Ee((j(),U("span",{class:"button",key:m,onClick:u=>r(i.key)},[E("b",ft,q(i.name),1),bt],8,ht)),[[ve,i.key!==c.currentRoom]])),128))]),(j(!0),U(ye,null,ge(we(a),(i,m)=>Ee((j(),U("div",{class:Pe(["point",[`point-${m}`,`point-${i.key}`]]),key:m,onClick:u=>d(i)},[E("div",{class:Pe(["label",[`label-${m}`,`label-${i.key}`]])},[E("label",gt,[E("div",wt,[E("i",{class:"icon",style:Be({background:`url(${i.cover}) no-repeat center`,"background-size":"contain"})},null,4)]),E("div",Et,[E("p",vt,q(i.value),1),E("p",Pt,q(i.description),1)])])],2)],10,yt)),[[ve,i.room===c.currentRoom]])),128)),_t]))}},Mt=st(xt,[["__scopeId","data-v-6ace4ada"]]);export{Mt as default};
